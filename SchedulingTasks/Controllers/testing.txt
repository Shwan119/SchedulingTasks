-- Declare mapping table
DECLARE @UserMappings TABLE (
    InventoryID INT,
    PrimaryAnalystUserName NVARCHAR(100),
    ContactSupportUserName NVARCHAR(100)
);

-- Insert mappings
INSERT INTO @UserMappings (InventoryID, PrimaryAnalystUserName, ContactSupportUserName)
VALUES
    (1, 'ewew', 'rerere'),
    (2, 'hyhy', 'trhgy'),
    (3, 'hyherr', 'rrr');

-- Now join safely
WITH Updates AS (
    SELECT 
        m.InventoryID,
        u1.ID AS PrimaryAnalystID,
        u2.ID AS ContactSupportID
    FROM @UserMappings m
    LEFT JOIN users u1 ON u1.UserName = m.PrimaryAnalystUserName
    LEFT JOIN users u2 ON u2.UserName = m.ContactSupportUserName
)
UPDATE inv
SET 
    PrimaryAnalystID = ISNULL(u.PrimaryAnalystID, inv.PrimaryAnalystID),
    [Contact supportID] = ISNULL(u.ContactSupportID, inv.[Contact supportID])
FROM inventories inv
JOIN Updates u ON inv.ID = u.InventoryID;
