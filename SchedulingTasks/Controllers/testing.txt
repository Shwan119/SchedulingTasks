-- Step 1: Build temp table with only the needed columns
SELECT
  t.ID,
  t.Title            AS OriginalTitle,
  -- Extract just the digits after the last ' - '
  ExtractedNumber = SUBSTRING(
    t.Title,
    PATINDEX('% - [0-9]%', t.Title) + 3,
    CASE
      -- find end of the number block (next dash or end-of-string)
      WHEN CHARINDEX(' - ', t.Title, PATINDEX('% - [0-9]%', t.Title) + 3) > 0
        THEN CHARINDEX(' - ', t.Title, PATINDEX('% - [0-9]%', t.Title) + 3)
      ELSE LEN(t.Title) + 1
    END
    - (PATINDEX('% - [0-9]%', t.Title) + 3)
  ),
  -- Reconstruct Title without the ' - NNNN' block, preserving any text before or after
  NewTitle = RTRIM(
    LEFT(t.Title, PATINDEX('% - [0-9]%', t.Title) - 1)
    +
    -- append trailing text if exists
    ISNULL(
      ' - ' + LTRIM(
        SUBSTRING(
          t.Title,
          CHARINDEX(' - ', t.Title, PATINDEX('% - [0-9]%', t.Title) + 3) + 3,
          LEN(t.Title)
        )
      ),
      ''
    )
  )
INTO #TempTitleNumbers
FROM MyTable t
WHERE
  PATINDEX('% - [0-9]%', t.Title) > 0
  AND -- ensure the suffix is purely digits
  SUBSTRING(
    t.Title,
    PATINDEX('% - [0-9]%', t.Title) + 3,
    CASE
      WHEN CHARINDEX(' - ', t.Title, PATINDEX('% - [0-9]%', t.Title) + 3) > 0
        THEN CHARINDEX(' - ', t.Title, PATINDEX('% - [0-9]%', t.Title) + 3)
      ELSE LEN(t.Title) + 1
    END
    - (PATINDEX('% - [0-9]%', t.Title) + 3)
  ) NOT LIKE '%[^0-9]%';

-- Step 2: Preview changes
SELECT ID, OriginalTitle, ExtractedNumber, NewTitle
FROM #TempTitleNumbers;

-- Step 3: Apply updates
UPDATE m
SET
  m.ait   = tmp.ExtractedNumber,
  m.Title = tmp.NewTitle
FROM MyTable m
JOIN #TempTitleNumbers tmp
  ON m.ID = tmp.ID;

-- Step 4: Clean up
DROP TABLE #TempTitleNumbers;
